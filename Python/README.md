# HC-SR04 sensor using Python

## Wiring

|color (*)|function|Pin#|Pi pin ID|
|---|---|---|---|
|red|Vcc (5.0)|2|5V|
|green|Gnd|6|Ground|
|yellow|trig|24|GPIO 8|
|orange|echo|23|GPIO 11|

(*) DuPont jumper colors - arbitrary assignments.

## Requirements

```text
sudo apt install python3-rpi.gpio # pre-installed on R-Pi OS, not Debian.
```

Add `iomem=relaxed` to `/boot/firmware/cmdline.txt`

Creata a `gpio` group, add `$USER` to that and change the ownership and permissions of the GPIO chip devices.

```text
sudo chown root.gpio /dev/gpiochip?
sudo chmod g+rw /dev/gpiochip?
```

## Status

Distance from sensor PCB to cardboard box. A series of 10 (or more) batches of 5 readings plus mean and standard deviation.

## Pi Zero results

### 7" measurement

```text
hbarta@amity:~ $ ultrasonic-hcsr04.py 
[15.983426570892334, 16.482269763946533, 16.56813621520996, 16.445469856262207, 16.482269763946533] 16.392314434051514 0.2329763963538204
[16.461825370788574, 16.482269763946533, 16.4986252784729, 16.465914249420166, 16.465914249420166] 16.474909782409668 0.015408075291457064
[16.375958919525146, 17.97471046447754, 16.56404733657837, 16.600847244262695, 16.465914249420166] 16.796295642852783 0.6645742378034152
[16.514980792999268, 16.445469856262207, 16.514980792999268, 16.514980792999268, 16.425025463104248] 16.48308753967285 0.04426577025160269
[16.547691822052002, 19.68386173248291, 16.547691822052002, 16.330981254577637, 16.4495587348938] 17.11195707321167 1.440501554286827
[16.551780700683594, 16.56813621520996, 16.482269763946533, 16.510891914367676, 16.461825370788574] 16.514980792999268 0.044977664947509766
[16.482269763946533, 16.47818088531494, 16.416847705841064, 16.42911434173584, 16.551780700683594] 16.471638679504395 0.05335947448579425
[16.412758827209473, 16.4986252784729, 16.4495587348938, 16.425025463104248, 16.482269763946533] 16.45364761352539 0.03657204228794231
[16.343247890472412, 16.461825370788574, 16.33915901184082, 16.482269763946533, 16.56813621520996] 16.43892765045166 0.09773189771727149
[30.666589736938477, 16.514980792999268, 16.56813621520996, 16.4986252784729, 16.425025463104248] 19.33467149734497 6.3349416399137946
^Chbarta@amity:~ $ 
```

### 5" measurement

```text
hbarta@amity:~ $ ultrasonic-hcsr04.py 
[11.506104469299316, 11.596059799194336, 11.575615406036377, 11.596059799194336, 11.665570735931396] 11.587882041931152 0.05702483306618457
[11.48974895477295, 12.434279918670654, 11.473393440246582, 11.632859706878662, 11.591970920562744] 11.724450588226318 0.40246489863923063
[11.579704284667969, 11.42432689666748, 11.53881549835205, 11.53881549835205, 11.677837371826172] 11.551899909973145 0.09117374201076271
[11.624681949615479, 11.575615406036377, 11.563348770141602, 11.53881549835205, 11.522459983825684] 11.564984321594238 0.0392830382890232
[11.48974895477295, 11.579704284667969, 11.542904376983643, 11.579704284667969, 11.493837833404541] 11.537179946899414 0.04409548027122706
[11.457037925720215, 11.383438110351562, 11.55925989151001, 11.661481857299805, 11.579704284667969] 11.528184413909912 0.10885943457139495
[11.526548862457275, 11.420238018035889, 11.55925989151001, 11.55925989151001, 11.473393440246582] 11.507740020751953 0.06020517993471093
[11.440682411193848, 11.575615406036377, 11.542904376983643, 11.55925989151001, 11.575615406036377] 11.53881549835205 0.05650942697110464
[11.542904376983643, 11.473393440246582, 11.677837371826172, 11.579704284667969, 11.575615406036377] 11.569890975952148 0.0738605873099223
[11.612415313720703, 11.473393440246582, 11.661481857299805, 11.555171012878418, 11.596059799194336] 11.579704284667969 0.0705849890716052
^Chbarta@amity:~ $ 
```

### 3" measurement

```text
hbarta@amity:~ $ ultrasonic-hcsr04.py 
[6.227362155914307, 6.215095520019531, 6.329584121704102, 6.276428699493408, 6.227362155914307] 6.255166530609131 0.04780666816473922
[6.280517578125, 6.260073184967041, 6.1905622482299805, 6.260073184967041, 6.243717670440674] 6.246988773345947 0.0341366271610567
[6.153762340545654, 6.280517578125, 6.399095058441162, 6.12105131149292, 6.378650665283203] 6.266615390777588 0.12670906441084495
[6.243717670440674, 6.313228607177734, 5.180609226226807, 6.243717670440674, 6.092429161071777] 6.014740467071533 0.47322477461513773
[6.32549524307251, 6.125140190124512, 6.227362155914307, 6.280517578125, 6.239628791809082] 6.239628791809082 0.07467102947399781
[6.243717670440674, 6.104695796966553, 6.243717670440674, 6.260073184967041, 6.239628791809082] 6.218366622924805 0.06402719156222096
[6.276428699493408, 6.260073184967041, 6.260073184967041, 6.223273277282715, 6.104695796966553] 6.224908828735352 0.06996643662661696
[6.255984306335449, 6.125140190124512, 6.280517578125, 6.137406826019287, 6.1905622482299805] 6.197922229766846 0.06929412857398984
[6.260073184967041, 6.1087846755981445, 6.206917762756348, 6.378650665283203, 6.378650665283203] 6.266615390777588 0.11578098653209604
[6.1087846755981445, 6.3500285148620605, 6.2110066413879395, 6.223273277282715, 6.223273277282715] 6.223273277282715 0.08562271971512521
^Chbarta@amity:~ $ 
```

### 2" measurement

```text
hbarta@amity:~ $ ultrasonic-hcsr04.py 
[3.8599014282226562, 3.806746006011963, 3.806746006011963, 3.8967013359069824, 3.908967971801758] 3.8558125495910645 0.04829379381154867
[3.7576794624328613, 3.806746006011963, 3.82310152053833, 3.904879093170166, 3.888523578643799] 3.836185932159424 0.060537501759523
[3.8762569427490234, 3.9130568504333496, 3.8803458213806152, 3.843545913696289, 3.704524040222168] 3.843545913696289 0.0815216171600851
[3.7167906761169434, 3.7576794624328613, 3.7576794624328613, 3.8394570350646973, 3.82310152053833] 3.7789416313171387 0.050938960507605754
[3.7167906761169434, 3.741323947906494, 3.8762569427490234, 3.7535905838012695, 3.82310152053833] 3.782212734222412 0.06574072564183521
[3.8558125495910645, 3.7331461906433105, 3.843545913696289, 3.9948344230651855, 3.82310152053833] 3.850088119506836 0.09411529259460369
[3.8721680641174316, 3.8599014282226562, 3.724968433380127, 3.8762569427490234, 3.8599014282226562] 3.838639259338379 0.06396187767032324
[3.704524040222168, 3.8599014282226562, 3.8599014282226562, 3.8721680641174316, 3.82310152053833] 3.8239192962646484 0.06923378359295909
[3.8967013359069824, 3.8762569427490234, 3.720879554748535, 3.843545913696289, 3.8599014282226562] 3.8394570350646973 0.06914921214787606
[3.7167906761169434, 3.8599014282226562, 3.8762569427490234, 3.8599014282226562, 3.8599014282226562] 3.834550380706787 0.06620953891420356
^Chbarta@amity:~ $ 
```

### 1" measurement

```text
hbarta@amity:~ $ ultrasonic-hcsr04.py 
[2.093505859375, 2.089416980743408, 2.056705951690674, 2.056705951690674, 1.9258618354797363] 2.0444393157958984 0.06854209581237307
[1.9258618354797363, 1.9585728645324707, 2.0076394081115723, 2.077150344848633, 1.9217729568481445] 1.9781994819641113 0.06512750687143173
[0.6174206733703613, 1.991283893585205, 2.011728286743164, 1.950395107269287, 2.0403504371643066] 1.7222356796264648 0.618478542967326
[2.0403504371643066, 2.011728286743164, 1.950395107269287, 2.0035505294799805, 1.954483985900879] 1.9921016693115234 0.038725803842021844
[1.9871950149536133, 1.991283893585205, 1.970839500427246, 1.974928379058838, 2.130305767059326] 2.0109105110168457 0.06727416989584102
[2.0239949226379395, 2.0444393157958984, 2.1589279174804688, 1.970839500427246, 2.0239949226379395] 2.0444393157958984 0.069571041319615
[2.0076394081115723, 1.991283893585205, False, 2.0035505294799805, 0.5519986152648926] 1.31089448928833 0.9646920393389474
[2.0076394081115723, 1.9871950149536133, 2.1793723106384277, 2.0239949226379395, 2.0239949226379395] 2.0444393157958984 0.07693179236321193
[2.0076394081115723, 1.9790172576904297, 0.7196426391601562, 1.954483985900879, 2.0076394081115723] 1.7336845397949219 0.5673015190052043
[2.0239949226379395, 1.8195509910583496, 1.9871950149536133, 1.991283893585205, 1.8359065055847168] 1.9315862655639648 0.0960494910261028
^Chbarta@amity:~ $ 
```

## Pi Zero 2 results

## 7" measurement

```text
hbarta@zberry:~ $ ultrasonic-hcsr04.py 
[16.40866994857788, 16.42911434173584, 16.437292098999023, 16.43320322036743, 16.4495587348938] 16.431567668914795 0.014911798971610048
[16.40458106994629, 16.445469856262207, 16.40866994857788, 16.425025463104248, 16.40458106994629] 16.417665481567383 0.017681740928842546
[16.38004779815674, 16.420936584472656, 16.38004779815674, 16.40458106994629, 16.400492191314697] 16.397221088409424 0.017443752407173226
[16.42911434173584, 16.416847705841064, 16.441380977630615, 16.42911434173584, 16.420936584472656] 16.427478790283203 0.00941330552242975
[16.371870040893555, 16.437292098999023, 16.420936584472656, 16.425025463104248, 16.412758827209473] 16.41357660293579 0.024938807887640375
[16.375958919525146, 16.40866994857788, 16.40458106994629, 16.388225555419922, 16.392314434051514] 16.39394998550415 0.013122688869970455
[16.43320322036743, 16.425025463104248, 16.412758827209473, 16.36369228363037, 16.35960340499878] 16.39885663986206 0.03476749240222974
[16.392314434051514, 16.375958919525146, 16.420936584472656, 16.45364761352539, 16.416847705841064] 16.411941051483154 0.02968311860379394
[16.38413667678833, 16.36369228363037, 16.40866994857788, 16.457736492156982, 16.445469856262207] 16.411941051483154 0.039790482851181815
[16.392314434051514, 16.392314434051514, 16.412758827209473, 16.441380977630615, 16.465914249420166] 16.420936584472656 0.03219586254103245
^Chbarta@zberry:~ $
```

### 5" measurement

```text
hbarta@zberry:~ $ ultrasonic-hcsr04.py 
[11.375260353088379, 11.436593532562256, 11.481571197509766, 11.436593532562256, 11.420238018035889] 11.430051326751709 0.03820422038070431
[11.391615867614746, 11.403882503509521, 11.391615867614746, 11.448860168457031, 11.44477128982544] 11.416149139404297 0.028475744599545914
[11.412060260772705, 11.346638202667236, 11.395704746246338, 11.403882503509521, 11.407971382141113] 11.393251419067383 0.026750142770729405
[11.358904838562012, 11.412060260772705, 11.42432689666748, 11.407971382141113, 11.416149139404297] 11.403882503509521 0.025860339103645186
[11.367082595825195, 11.407971382141113, 11.387526988983154, 11.350727081298828, 11.457037925720215] 11.394069194793701 0.04125514413529298
[11.371171474456787, 11.416149139404297, 11.35481595993042, 11.350727081298828, 11.42432689666748] 11.383438110351562 0.03457460607393803
[11.919081211090088, 11.371171474456787, 11.485660076141357, 11.436593532562256, 11.420238018035889] 11.526548862457275 0.22320933408436633
[11.371171474456787, 11.432504653930664, 11.432504653930664, 11.420238018035889, 11.465215682983398] 11.42432689666748 0.034087615467207684
[11.395704746246338, 11.412060260772705, 11.39979362487793, 11.497926712036133, 11.461126804351807] 11.433322429656982 0.04454814035022681
[11.350727081298828, 11.44477128982544, 11.448860168457031, 11.403882503509521, 11.391615867614746] 11.407971382141113 0.040580961714737226
^Chbarta@zberry:~ $ 
```

### 3" measurement

```text
hbarta@zberry:~ $ ultrasonic-hcsr04.py 
[6.337761878967285, 6.366384029388428, 6.358206272125244, 6.3500285148620605, 6.345939636230469] 6.351664066314697 0.011047541707836292
[6.305050849914551, 6.321406364440918, 6.3500285148620605, 6.309139728546143, 6.354117393493652] 6.327948570251465 0.022875805142545138
[6.366384029388428, 6.341850757598877, 6.329584121704102, 6.3500285148620605, 6.276428699493408] 6.332855224609375 0.03425884963283119
[6.313228607177734, 6.337761878967285, 6.362295150756836, 6.3500285148620605, 6.354117393493652] 6.343486309051514 0.0190911665571478
[6.358206272125244, 6.32549524307251, 6.337761878967285, 6.341850757598877, 5.851185321807861] 6.2428998947143555 0.21928744160994418
[6.317317485809326, 6.329584121704102, 6.32549524307251, 6.366384029388428, 6.362295150756836] 6.34021520614624 0.022507410611969706
[6.300961971282959, 6.337761878967285, 6.358206272125244, 5.924785137176514, 6.300961971282959] 6.244535446166992 0.1804303120456281
[6.354117393493652, 6.284606456756592, 5.892074108123779, 6.32549524307251, 6.309139728546143] 6.233086585998535 0.19229905349852217
[6.333673000335693, 6.333673000335693, 6.345939636230469, 6.337761878967285, 6.305050849914551] 6.331219673156738 0.01546223389532051
[6.329584121704102, 6.345939636230469, 6.329584121704102, 6.354117393493652, 6.345939636230469] 6.341032981872559 0.010971612686382692
^Chbarta@zberry:~ $ 
```

### 2" measurement

```text
hbarta@zberry:~ $ ultrasonic-hcsr04.py 
[3.847634792327881, 3.8558125495910645, 3.86807918548584, 3.8803458213806152, 3.884434700012207] 3.8672614097595215 0.01567699742996578
[3.86807918548584, 3.888523578643799, 5.495452880859375, 3.8762569427490234, 3.925323486328125] 4.210727214813232 0.7185173176911538
[3.82310152053833, 3.8394570350646973, 3.8190126419067383, 3.86807918548584, 3.8762569427490234] 3.845181465148926 0.02595713422345939
[3.843545913696289, 3.847634792327881, 3.908967971801758, 3.8762569427490234, 3.847634792327881] 3.8648080825805664 0.027942332745559555
[3.82310152053833, 3.8190126419067383, 3.8721680641174316, 3.863990306854248, 3.8721680641174316] 3.850088119506836 0.026750142770729405
[3.884434700012207, 3.8926124572753906, 3.8353681564331055, 3.863990306854248, 3.884434700012207] 3.8721680641174316 0.023130190462778644
[3.888523578643799, 3.863990306854248, 3.8967013359069824, 3.900790214538574, 3.8721680641174316] 3.884434700012207 0.015836158844818402
[3.8394570350646973, 3.8721680641174316, 3.8599014282226562, 3.8803458213806152, 3.863990306854248] 3.8631725311279297 0.015408075291457064
[3.843545913696289, 3.8721680641174316, 3.8599014282226562, 3.8599014282226562, 3.8762569427490234] 3.8623547554016113 0.012800214800779808
[3.863990306854248, 3.884434700012207, 3.8926124572753906, 3.8721680641174316, 3.863990306854248] 3.875439167022705 0.012734740126901439
^Chbarta@zberry:~ $ 
```

### 1" measurement

```text
hbarta@zberry:~ $ ultrasonic-hcsr04.py 
[2.097594738006592, 2.0648837089538574, 2.056705951690674, 2.097594738006592, 2.077150344848633] 2.0787858963012695 0.018648155727815835
[2.0812392234802246, 2.077150344848633, 2.0403504371643066, 2.1016836166381836, 2.093505859375] 2.0787858963012695 0.023595345258068817
[2.068972587585449, 2.0444393157958984, 2.089416980743408, 2.089416980743408, 2.093505859375] 2.077150344848633 0.020647824966062264
[2.073061466217041, 2.1016836166381836, 2.097594738006592, 2.089416980743408, 2.097594738006592] 2.0918703079223633 0.011419616544277065
[2.0607948303222656, 2.089416980743408, 2.097594738006592, 2.097594738006592, 2.1016836166381836] 2.089416980743408 0.016609103517473547
[2.0648837089538574, 2.093505859375, 2.097594738006592, 2.0853281021118164, 2.093505859375] 2.086963653564453 0.013122688869970455
[2.068972587585449, 2.318394184112549, 2.097594738006592, 2.093505859375, 2.1016836166381836] 2.1360301971435547 0.10273587269913317
[2.0853281021118164, 2.089416980743408, 2.1016836166381836, 2.1016836166381836, 2.0485281944274902] 2.0853281021118164 0.02182863855628216
[2.077150344848633, 2.0444393157958984, 2.097594738006592, 2.0853281021118164, 2.0853281021118164] 2.077968120574951 0.02011462325836827
[2.0648837089538574, 2.0444393157958984, 2.0853281021118164, 2.0403504371643066, 2.0444393157958984] 2.0558881759643555 0.01904732914784563
^Chbarta@zberry:~ $ 
```
